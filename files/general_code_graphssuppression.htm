<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="general_code_graphssuppression_files/filelist.xml">
<title>General code for graphs in “Graphical Views of Suppression and
Multicollinearity in Multiple Linear Regression</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>VALUED SONY CUSTOMER</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>melanie</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>2</o:TotalTime>
  <o:Created>2005-05-16T19:15:00Z</o:Created>
  <o:LastSaved>2005-05-16T19:15:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>717</o:Words>
  <o:Characters>4089</o:Characters>
  <o:Company>SONY</o:Company>
  <o:Lines>34</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>4797</o:CharactersWithSpaces>
  <o:Version>10.3501</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.Lecture, li.Lecture, div.Lecture
	{mso-style-name:Lecture;
	mso-style-parent:"Normal Indent";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-element:frame;
	mso-element-frame-hspace:9.35pt;
	mso-element-frame-vspace:9.35pt;
	mso-element-wrap:around;
	mso-element-anchor-vertical:paragraph;
	mso-element-anchor-horizontal:column;
	mso-element-top:.05pt;
	mso-height-rule:exactly;
	font-size:16.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-even-footer:url("general_code_graphssuppression_files/header.htm") ef1;
	mso-footer:url("general_code_graphssuppression_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoBodyText>General code for graphs in “Graphical Views of Suppression
and Multicollinearity in Multiple Linear Regression.”<span
style='mso-spacerun:yes'>  </span>(The American Statistician, 59, 127-136.)</p>

<p class=MsoFooter style='tab-stops:.5in'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b>1)<span style='mso-spacerun:yes'>  </span></b>You will
need this function to make the calculations for the <span style='font-family:
Symbol'>b</span>’s, R<sup>2</sup>, standard errors of</p>

<p class=MsoNormal>the <span style='font-family:Symbol'>b</span>’s, etc.<span
style='mso-spacerun:yes'>  </span>It calculates the limits that r<sub>12</sub>
can go between, given r<sub>y1</sub> and r<sub>y2</sub>.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&gt; F.limcor</p>

<p class=MsoNormal>function(r1, r2)</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>ll &lt;- r1
* r2 - sqrt((1 - r1^2) * (1 - r2^2))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span><span
lang=FR style='mso-ansi-language:FR'>ul &lt;- r1 * r2 + sqrt((1 - r1^2) * (1 -
r2^2))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='mso-ansi-language:FR'><span
style='mso-tab-count:1'>            </span>print(ll, digits = 4)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='mso-ansi-language:FR'><span
style='mso-tab-count:1'>            </span>print(ul, digits = 4)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='mso-ansi-language:FR'><span
style='mso-tab-count:1'>            </span></span>Ll &lt;&lt;- ll</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Ul
&lt;&lt;- ul</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b>2) </b>This is the function that makes all the
calculations needed for the graphs of the <span style='font-family:Symbol'>b</span>’s,
R<sup>2</sup>, and standard errors of the <span style='font-family:Symbol'>b</span>’s.<span
style='mso-spacerun:yes'>  </span>It produces a matrix holding</p>

<p class=MsoNormal>1) values of r<sub>12</sub> between the limits given by
F.limcor;</p>

<p class=MsoNormal>2)<span style='mso-spacerun:yes'>  </span>values of <span
style='font-family:Symbol'>b</span><sub>1</sub> at the above values of r<sub>12</sub>;</p>

<p class=MsoNormal>3)<span style='mso-spacerun:yes'>  </span>values of <span
style='font-family:Symbol'>b</span><sub>2</sub> at those same values;</p>

<p class=MsoNormal>4) values of the derivative of <span style='font-family:
Symbol'>b</span><sub>1</sub> at the above values of r<sub>12</sub>;</p>

<p class=MsoNormal>5) values of the derivative of <span style='font-family:
Symbol'>b</span><sub>2</sub> at the above values of r<sub>12</sub>;</p>

<p class=MsoNormal>6)<span style='mso-spacerun:yes'>  </span>R<sup>2</sup> at
those values;</p>

<p class=MsoNormal>7) the standard errors of the <span style='font-family:Symbol'>b</span>’s
at those values;</p>

<p class=MsoNormal>8) the t-stat of <span style='font-family:Symbol'>b</span><sub>1</sub>
at those values;</p>

<p class=MsoNormal>9) the t-stat of <span style='font-family:Symbol'>b</span><sub>2</sub>
at those values;</p>

<p class=MsoNormal>10) a sequence actually just the same as 1) for the purpose
of creating the x-axis;</p>

<p class=MsoNormal>11) a sequence of values between –1 and the maximum value of
<span style='font-family:Symbol'>b</span><sub>1</sub> for the purpose</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>of creating
the y-axis. </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&gt; F.betcal</p>

<p class=MsoNormal>function(v1, v2, lr = 101, mn = 25)</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#v1 and v2
are the correlations or vectors of correlations </p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#from which
we will get the betas and their </p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#se's and
t's and r sq's</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span># lr is the
number of points at which we want to calculate</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span># mn is the
number of subjects that the </p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#t-statistic
is based on</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>F.limcor(v1,
v2)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>ll &lt;-
round(Ll, digits = 2)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>ul &lt;-
round(Ul, digits = 2)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>bnew &lt;-
(ul - ll)/(lr - 1)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>rho1 &lt;-
seq(ll, ul, by = bnew)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>print(rho1)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>vec1 &lt;-
c(rep(v1, length(rho1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>vec2 &lt;-
c(rep(v2, length(rho1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>be1 &lt;-
c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>be2 &lt;-
c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>be1pr &lt;-
c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>be2pr &lt;-
c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>rsq &lt;-
c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>sebe &lt;-
c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>tstat1
&lt;- c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>tstat2
&lt;- c(rep(0, length(vec1)))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>for(i in
1:length(vec1)) {</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>be1[i]
&lt;- (vec1[i] - vec2[i] * rho1[i])/(1 - rho1[</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span>i]^2)</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>be2[i]
&lt;- (vec2[i] - vec1[i] * rho1[i])/(1 - rho1[</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span>i]^2)</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>be1pr[i]
&lt;- (1/(1 - rho1[i]^2)^2) * (vec1[i] * rho1[</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span>i]
* 2 - vec2[i] * (1 + rho1[i]^2))</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>be2pr[i]
&lt;- (1/(1 - rho1[i]^2)^2) * (vec2[i] * rho1[</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span>i]
* 2 - vec1[i] * (1 + rho1[i]^2))</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>rsq[i]
&lt;- vec1[i]^2 + (vec2[i] - vec1[i] * rho1[i])^</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span>2/(1
- rho1[i]^2)</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>sebe[i]
&lt;- (sqrt((1 - rsq[i])/(mn - 3)) * sqrt(1/(</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span>1
- rho1[i]^2)))</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>tstat1[i]
&lt;- be1[i]/sebe[i]</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>tstat2[i]
&lt;- be2[i]/sebe[i]</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>}</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>lo &lt;-
seq(Ll, Ul, length = lr)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>lo1 &lt;-
seq(-1, max(be1), length = lr)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Bp
&lt;&lt;- cbind(rho1, be1, be2, be1pr, be2pr, rsq, sebe, tstat1,</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>tstat2,
lo, lo1)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>invisible()</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>&gt;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b>3</b>)<span style='mso-spacerun:yes'>  </span>The
following will produce a graph, based on the two correlations of the
independent variables with the dependent variable, with all the annotations
that do not involve</p>

<p class=MsoNormal>subscripts or Greek letters.<span style='mso-spacerun:yes'> 
</span>(Those can be added by the user, using text boxes.)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>F.betgraph</p>

<p class=MsoNormal>function(look = 1, look1 = 1, h1 = 0, v1 = 0, r1 = 1, r2 =
1, x1 = 1,</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>y1 = 1, y2
= 1, y3 = 1)</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#look and
look1 set x and y limits respectively</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#use
Bpl[,10],Bpl[,11]</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#h1 and v1
are usually intended for the axes</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#r1 and r2
are for the larger and smaller</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#
correlations, resp.</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#x1 and
y1,y2,y3 are for the rho, </p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>#beta1,beta2,rsquared</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>plot(look,
look1, type = &quot;n&quot;, cex = 0.7, xlab = c(&quot;<span
style='mso-spacerun:yes'>     </span>&quot;),</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>ylab
= c(&quot;<span style='mso-spacerun:yes'>            </span>&quot;))</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>abline(v =
v1)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>abline(h =
h1)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>abline(v =
(r2/r1), lty = 7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>abline(v =
((2 * r1 * r2)/(r1^2 + r2^2)), lty = 7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text(-0.15,
-0.45, c(&quot;Region I&quot;), cex = 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text(-0.15,
-0.55, c(&quot;Enhancement&quot;), cex = 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text((r2/r1)/2,
-0.45, c(&quot;Region II&quot;), cex = 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text((r2/r1)/2,
-0.55, c(&quot;Redundancy&quot;), cex = 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text(((2 *
r1 * r2)/(r1^2 + r2^2) + r2/r1)/2, -0.45, c(</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>&quot;Region
III&quot;), cex = 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text(((2 *
r1 * r2)/(r1^2 + r2^2) + r2/r1)/2, -0.55, c(</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>&quot;Suppression&quot;),
cex = 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text((2 *
r1 * r2)/(r1^2 + r2^2) + 0.1, -0.45, c(&quot;Region IV&quot;),</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>cex
= 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>text((2 *
r1 * r2)/(r1^2 + r2^2) + 0.1, -0.55, c(&quot;Enhancement&quot;),</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>cex
= 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>legend(-0.4,
-0.65, legend = c(&quot;<span style='mso-spacerun:yes'>  </span>&quot;,
&quot;<span style='mso-spacerun:yes'>   </span>&quot;, &quot;<span
style='mso-spacerun:yes'>  </span>&quot;), lty = c(</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>1,
6, 3), cex = 0.7)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>lines(x1,
y1, lty = 6)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>lines(x1,
y2, lty = 3)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>lines(x1,
y3, lty = 0)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>points(Bp[1,
10], 0, pch = &quot;[&quot;, cex = 1.5)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>points(Bp[100,
10], 0, pch = &quot;]&quot;, cex = 1.5)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>points(r2/r1,
0, pch = 15)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>points((2 *
r1 * r2)/(r1^2 + r2^2), 0, pch = 15)</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>points(0,
0)</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b>4) </b><span style='mso-spacerun:yes'> </span>Once one
has the function F.betgraph, one can make the graph more quickly using the
following function:<span style='mso-spacerun:yes'>  </span>(one must, however,
have the matrix Bp given by F.betcal for the</p>

<p class=MsoNormal>given correlations).</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&gt; F.betshort</p>

<p class=MsoNormal>function(r1 = 0, r2 = 0)</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>F.betgraph(Bp[,
10], Bp[, 11], 0, 0, r1, r2, Bp[, 1], Bp[,</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>2],
Bp[, 3], Bp[, 6])</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
